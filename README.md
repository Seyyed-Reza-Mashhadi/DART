# Data Analysis & Representation Toolkit (DART) for Borehole NMR Data
 <img width="1400" height="600" alt="VB-V03" src="https://github.com/user-attachments/assets/630ed34b-e852-469b-9de0-11e70bc858e0" />

## üîç Overview
DART is a powerful Python toolkit designed for processing, statistical analysis, visualization, and interpretation of Borehole Nuclear Magnetic Resonance (BNMR) data from Vista Clara NMR logging systems. It takes processed/inverted NMR data product text files, and performs geospatial analysis, statistical modeling, and geological illustrations using a unified workflow for comprehensive subsurface characterization.

## üåü Features
### Core Functionality
- Statistical Modeling: Statistical distribution analysis, model calibration for improved hydraulic conductivity (K) estimation
- Geospatial Analysis: Coordinate handling, profile azimuth calculation, generating shape files, creating PNG-embedded KML exports
- Geological Integration: linking geology logs to NMR data (Geo-labeling), geological section plots

### Advanced Visualization Engine
- Professional borehole log plots with comprehensive illustration of spin-echo decay, porosity, water partitioning, relaxation time distribution, hydraulic conductivity, etc. 
- Interactive section plotting with topography-aware scaling, capable of handling both numerical and categorical data variables
- Statistical graphics (histograms, KDEs, box plots, pair plots, etc.)
- Ternary diagrams, particularly for water partitioning data analysis


## üß© Architecture
#### Data Class
- Purpose: Manages borehole-specific data operations by loading Vista Clara exports to process borehole data.
- Input: Accepts borehole names to load and manage related data.
- Description: Add all export files (named after boreholes) in a single folder and use it as input directory for all functions within this class. Note that borehole names can be extracted by a dedicated function out of this class.
- Key Functions:

| Function                    | Description                                             |
|----------------------------|---------------------------------------------------------|
| `import_data()`            | Loads Vista Clara processed files for a borehole        |
| `logplot()`                | Generates professional multi-panel borehole log         |
| `export_las()`             | Creates LAS files from BNMR data                        |
| `create_BNMR_dataframe()`  | Builds core dataset without geology labels              |
| `geo_label()`              | Adds geological labels to BNMR measurements             |
| `geo_label_T2D()`          | Creates T‚ÇÇ distribution dataset with geology labels     |
| `geo_label_SpinEchoDecay()`| Processes spin echo decay with geology labels           |
| `export_kml()`             | Generates KML with embedded borehole logs
 
    
#### Statistics Class
- Purpose: Manages dataset-based statistical visualization and modeling
- Input: Accepts a pandas DataFrame (e.g., a geo-labeled BNMR dataset generated by the Data Class fucntions) as input
- Description: Designed to prepare a range of illustrations useful for analyzing BNMR datasets
- Key functions:

| Function                              | Description                                          |
|---------------------------------------|------------------------------------------------------|
| `qc_dataset()`                        | Data quality assessment with noise statistics        |
| `statistical_report()`                | Generates Excel report with key metrics              |
| `boxplot_WC()`                        | Water partitioning box plots by geology              |
| `water_fractions_pairplot()`          | Scatter matrix of porosity relationships             |
| `ternary_plot()`                      | 3D visualization of water fractions                  |
| `calibrate_K_estimation_models()`     | Hydraulic conductivity model fitting                 |
| `k_calculation_in_BNMR_dataframe()`   | Applies K models to full dataset

#### Other Functions / Tools
- A collection of utility functions implemented outside the main classes to support additional tasks (e.g., various section plottings, or merging datasets).
- Function list:
- 
 
### Within Data Class

#### Geo-labeling & BNMR Data Integration of Individual Boreholes 
- Geo-labeling the BNMR data (if geology information is available)
- Merging all boreholes data into a unified dataframe


### Within Statistics Class

#### Statistical Graphics
- Class Name: ???
- Function Name: ???
- Various statistical graphs & illustrations including:
  - Histograms/KDEs/CDFs
  - Box plots of porosity by geology
  - Pair plots/grids 
  - Ternary diagrams 
  - And more...




### Outside Classes / Utility Functions

#### ‚öôÔ∏è Simple Preprocessings & Data Integration
- Function Name: get_borehole_names
  Scans directories for all borehole data files in a survey/project
- Function Name: add_coordinates
  Merges XYZ coordinates with BNMR measurements
- Function Name: check_NonNumeric_columns
  Cleans invalid entries in geology/hydrology data
- Function Name: merge_txt_files
  Combines project datasets for unified analysis

#### Geological Sections (section_plot_all())
- Class Name: -
- Function Name: section_plot_all
- This feature provides:
  - Interactive profile selection (Tkinter GUI)
  - Topography-aware elevation scaling
  - Automatic azimuth labeling
  - Custom numerical or categorical variable sections (if present in the dataset)

#### üíß Hydraulic Conductivity Calibration
- Class Name: ???
- Function Name: ???
- Supported Models:
  - Schlumberger-DOll Research (SDR) Model: $K = b \cdot \phi^m \cdot T_{2ML}^n$
  - Timur-Coates (TC) Model: $K = \left[ \left( \frac{\phi}{c} \right)^2 \cdot \frac{FFI}{BVI} \right]^2$
  - Sum of Echoes (SOE) Model: $K = c \cdot \text{SOE}^d$
- Outputs: relevant plots (data biplots and validation plot), Calibrated coefficients, R¬≤, K difference factors, RMS and other common error metrics

## üåê Geospatial Outputs
#### üóÇ Shapefile Creation 
- Class Name: ???
- Function Name: ???
- Exports averaged BNMR parameters per borehole/geology unit in individual shape files for spatial mapping purposes

#### üåç KML Generator (with embedded PNG logplots)
- Class Name: ???
- Function Name: ???
- This feature provides:
  - Point location of boreholes with their names
  - The PNG pictures of borehole logs are embedded in the KML file, i.e., the borehole logs can be seen by hovering or selecting the borehole on Google Earth
  - A unique data product to share with basic BNMR data/outcome with stakeholders
     

## üì• Installation
bash
pip install pandas numpy matplotlib seaborn geopandas shapely simplekml pyproj scipy
git clone https://github.com/yourusername/dart.git

## üìú License
Distributed under the MIT License. See LICENSE for more information.

DART transforms raw BNMR data into actionable insights through integrated geospatial, statistical, and geological analysis - enabling researchers to quantify subsurface water properties with unprecedented efficiency.
### mentioning publications that used dart
### maybe example or sth






































1. Core Functionality
DART provides an end-to-end solution for processing, visualizing, and interpreting borehole nuclear magnetic resonance (BNMR) data. It integrates:

Geospatial Analysis: Coordinate handling, profile azimuth calculation, KML/shapefile exports.

Statistical Modeling: Hydraulic conductivity (K) calibration, porosity distribution analysis.

Geological Integration: Lithology labeling, ternary plots of water fractions.

Automated Reporting: LAS file exports, Excel statistical reports, publication-ready figures.

2. Key Modules
2.1 Data Preprocessing & Integration
get_borehole_names(): Scans directories for borehole data files.

add_coordinates(): Merges XYZ coordinates with BNMR measurements.

remove_duplicates(): Ensures unique depth measurements per borehole.

check_NonNumeric_columns(): Cleans invalid entries in geology/hydrology data.

merge_txt_files(): Combines project datasets for unified analysis.

2.2 Visualization Engine
Log Plots (logplot())

Combines:

Spin-echo decay heatmaps

Water partitioning (clay-bound, capillary-bound, free porosity)

T‚ÇÇ distribution curves

Noise profiles

Hydraulic conductivity (K) from field/BNMR models

Customizable: Color palettes, noise filtering, K-plot overlays.

Section Plots (section_plot(), section_plot_geo(), etc.)

Projects data along user-defined transects:

Geology: Lithology-colored intervals from symbology files.

Porosity: Stacked clay/capillary/free water fractions.

Custom Variables: T‚ÇÇML, SOE, or user-defined parameters.

Features:

Interactive point selection (Tkinter GUI) for profile endpoints.

Topography-aware elevation scaling.

Automatic azimuth labeling (e.g., "N-S", "NE-SW").

Statistical Graphics

Histograms/KDEs/CDFs (hist_kde_cfd_plot).

Box plots of porosity by geology (boxplot_WC).

Pair plots/grids for parameter correlations (water_fractions_pairplot).

Ternary diagrams (ternary_plot).

2.3 Geological & Hydrological Tools
Geolabeling (geo_lable())

Assigns lithology symbols to BNMR measurements using TOP/BOTTOM intervals.

K Model Calibration (calibrate_K_estimation_models)

Fits field K data to NMR-derived models:

SDR: 
K
=
b
‚ãÖ
œï
m
‚ãÖ
T
2
M
L
n
K=b‚ãÖœï 
m
 ‚ãÖT 
2ML
n
‚Äã
 

Timur-Coates: 
K
=
[
(
œï
c
)
2
‚ãÖ
F
F
I
B
V
I
]
2
K=[( 
c
œï
‚Äã
 ) 
2
 ‚ãÖ 
BVI
FFI
‚Äã
 ] 
2
 

SOE: 
K
=
c
‚ãÖ
SOE
d
K=c‚ãÖSOE 
d
 

Outputs: Calibrated coefficients, R¬≤, K difference factors.

Water Partitioning: Classifies porosity into clay-bound, capillary-bound, and free fractions.

2.4 Geospatial Outputs
Shapefile Creation (create_avg_BNMR_shape_files)

Exports averaged BNMR parameters (min/mean/max) per borehole/geology.

KML Generator (export_kml)

Embeds borehole locations + PNG log plots into Google Earth.

2.5 Export Utilities
LAS Exporter (export_las)

Generates industry-standard LAS files for petrophysical software.

Statistical Reports (statistical_report)

Excel files with porosity/T‚ÇÇ statistics grouped by geology.

3. Advanced Features
Interactive Profile Selection:
GUI for defining section start/end points with buffer distance.

python
section_plot(data, variable="mlT2", point_start=(x1,y1), point_end=(x2,y2))
Noise-Aware Processing:
Auto-exclusion of high-noise measurements (configurable threshold).

Multi-Project Support:
Merge datasets from different campaigns via merge_txt_files().

Automated Section Grids:
Plot geology, porosity, and custom variables in aligned profiles:

python
section_plot_all(data_geo, data_nmr, geo_symbology_file, "mlT2")
4. Class Architecture
Data Class
Purpose: Borehole-centric data management.

Methods:

import_data(): Loads Vista Clara exports (spin echo, T‚ÇÇ bins, porosity).

logplot(): Generates multi-panel borehole logs.

geo_lable(): Tags BNMR data with geology from external files.

export_las()/export_kml(): Standardized output generation.

Statistics Class
Purpose: Dataset-wide statistical modeling.

Methods:

qc_dataset(): Noise distribution analysis.

calibrate_K_estimation_models(): Fits K models to field data.

boxplot_WC()/kde_comparison_plot(): Comparative visualizations.

statistical_report(): Exports descriptive statistics.

5. Technical Highlights
Dynamic Plot Styling:
Context-aware color scales (e.g., log scaling for T‚ÇÇML).

Topography Integration:
Elevation-based depth referencing in sections.

Geology-Averaged Analysis:
Shapefiles per lithology unit (e.g., Sandstone_Avg_BNMR.shp).

3D-Ready Workflow:
XYZ coordinates enable integration with modeling software (e.g., GOCAD).

6. Applications
Aquifer Characterization:
Map free vs. bound water in hydrogeological units.

Geotechnical Engineering:
Correlate T‚ÇÇML distributions with permeability.

Mineral Exploration:
Identify clay-bound water in alteration zones.

Academic Research:
Batch-process field campaigns into structured datasets.

7. Dependencies
Library	Role
pandas	Data manipulation
geopandas	Shapefile creation
matplotlib	Publication-quality plotting
seaborn	Statistical graphics
scipy	Curve fitting, interpolation
simplekml	Google Earth KML export
shapely	Geometric operations (buffers, points)
Summary
DART transforms raw Vista Clara BNMR exports into actionable insights through:

Unified Data Management: Merge multi-project data, add coordinates, remove noise.

Rich Visualization: Log plots, geological sections, statistical diagrams.

Model Calibration: Convert NMR parameters to hydraulic conductivity.

Geospatial Integration: KML/shapefile exports for GIS workflows.

Automation: Batch processing for large datasets.

Ideal for hydrogeologists, geophysicists, and researchers quantifying subsurface water properties.

